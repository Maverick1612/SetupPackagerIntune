; Form Designer for Purebasic - 6.10
; Warning: this file uses a strict syntax, if you edit it, make sure to respect the Form Designer limitation or it won't be opened again.

;
; This code is automatically generated by the FormDesigner.
; Manual modification is possible to adjust existing commands, but anything else will be dropped when the code is compiled.
; Event procedures needs to be put in another source file.
;

Global DebuggerWindow_PSADT

Global PD_Container_Details, PD_ButtonImage_RunInstallation, PD_Text_Publisher, PD_String_Publisher, PD_Text_ProductName, PD_String_ProductName, PD_Text_Version, PD_String_Version, PD_ButtonImage_RunUninstall, PD_ButtonImage_RunRepair, PD_ButtonImage_StartPowerShell, PD_ButtonImage_ScanEXE, PD_ButtonImage_RunHelp, PD_Button_ShowLogs, PD_Button_EditDeploymentFile, PD_Button_Close

Global Img_DebuggerWindow_PSADT_0, Img_DebuggerWindow_PSADT_1, Img_DebuggerWindow_PSADT_2, Img_DebuggerWindow_PSADT_3, Img_DebuggerWindow_PSADT_4, Img_DebuggerWindow_PSADT_5

UsePNGImageDecoder()

Img_DebuggerWindow_PSADT_0 = CatchImage(#PB_Any,?Img_DebuggerWindow_PSADT_0)
Img_DebuggerWindow_PSADT_1 = CatchImage(#PB_Any,?Img_DebuggerWindow_PSADT_1)
Img_DebuggerWindow_PSADT_2 = CatchImage(#PB_Any,?Img_DebuggerWindow_PSADT_2)
Img_DebuggerWindow_PSADT_3 = CatchImage(#PB_Any,?Img_DebuggerWindow_PSADT_3)
Img_DebuggerWindow_PSADT_4 = CatchImage(#PB_Any,?Img_DebuggerWindow_PSADT_4)
Img_DebuggerWindow_PSADT_5 = CatchImage(#PB_Any,?Img_DebuggerWindow_PSADT_5)

Declare PSADT_StartPowerShellEditor(EventType)
Declare PSADT_GenerateExecutableList(EventType)
Declare OpenSoftwareLogs_Folder(EventType)
Declare CloseDebuggerWindow(EventType)
Declare PSADT_StartInstallation(EventType)
Declare PSADT_StartRepair(EventType)
Declare PSADT_StartUninstall(EventType)
Declare PSADT_StartPowerShell(EventType)
Declare PSADT_StartHelp(EventType)

Procedure OpenDebuggerWindow_PSADT(x = 0, y = 0, width = 600, height = 453)
  DebuggerWindow_PSADT = OpenWindow(#PB_Any, x, y, width, height, "Debug PSADT Project", #PB_Window_SystemMenu | #PB_Window_ScreenCentered)
  PD_Container_Details = ContainerGadget(#PB_Any, 0, 0, 600, 380)
  SetGadgetColor(PD_Container_Details, #PB_Gadget_BackColor,RGB(255,255,255))
  PD_ButtonImage_RunInstallation = ButtonImageGadget(#PB_Any, 20, 20, 140, 280, ImageID(Img_DebuggerWindow_PSADT_0))
  GadgetToolTip(PD_ButtonImage_RunInstallation, "Run installation")
  PD_Text_Publisher = TextGadget(#PB_Any, 180, 20, 400, 25, "Publisher")
  SetGadgetColor(PD_Text_Publisher, #PB_Gadget_BackColor,RGB(255,255,255))
  PD_String_Publisher = StringGadget(#PB_Any, 180, 50, 400, 25, "Company")
  DisableGadget(PD_String_Publisher, 1)
  PD_Text_ProductName = TextGadget(#PB_Any, 180, 100, 400, 25, "Name")
  SetGadgetColor(PD_Text_ProductName, #PB_Gadget_BackColor,RGB(255,255,255))
  PD_String_ProductName = StringGadget(#PB_Any, 180, 130, 400, 25, "My Software")
  DisableGadget(PD_String_ProductName, 1)
  PD_Text_Version = TextGadget(#PB_Any, 180, 180, 400, 25, "Version")
  SetGadgetColor(PD_Text_Version, #PB_Gadget_BackColor,RGB(255,255,255))
  PD_String_Version = StringGadget(#PB_Any, 180, 210, 400, 25, "1.0")
  DisableGadget(PD_String_Version, 1)
  PD_ButtonImage_RunUninstall = ButtonImageGadget(#PB_Any, 20, 320, 40, 38, ImageID(Img_DebuggerWindow_PSADT_1))
  GadgetToolTip(PD_ButtonImage_RunUninstall, "Run uninstall")
  PD_ButtonImage_RunRepair = ButtonImageGadget(#PB_Any, 70, 320, 40, 38, ImageID(Img_DebuggerWindow_PSADT_3))
  GadgetToolTip(PD_ButtonImage_RunRepair, "Run repair")
  PD_ButtonImage_StartPowerShell = ButtonImageGadget(#PB_Any, 120, 320, 40, 38, ImageID(Img_DebuggerWindow_PSADT_2))
  GadgetToolTip(PD_ButtonImage_StartPowerShell, "Start PowerShell console")
  PD_ButtonImage_ScanEXE = ButtonImageGadget(#PB_Any, 490, 320, 40, 38, ImageID(Img_DebuggerWindow_PSADT_5))
  GadgetToolTip(PD_ButtonImage_ScanEXE, "Generate executable list")
  PD_ButtonImage_RunHelp = ButtonImageGadget(#PB_Any, 540, 320, 40, 38, ImageID(Img_DebuggerWindow_PSADT_4))
  GadgetToolTip(PD_ButtonImage_RunHelp, "Run PSADT help")
  CloseGadgetList()
  PD_Button_ShowLogs = ButtonGadget(#PB_Any, 20, 400, 140, 35, "Show logs")
  PD_Button_EditDeploymentFile = ButtonGadget(#PB_Any, 170, 400, 190, 35, "Edit in PS ISE (Admin)")
  PD_Button_Close = ButtonGadget(#PB_Any, 490, 400, 90, 35, "Close")
EndProcedure

Procedure DebuggerWindow_PSADT_Events(event)
  Select event
    Case #PB_Event_CloseWindow
      ProcedureReturn #False

    Case #PB_Event_Menu
      Select EventMenu()
      EndSelect

    Case #PB_Event_Gadget
      Select EventGadget()
        Case PD_ButtonImage_RunInstallation
          PSADT_StartInstallation(EventType())          
        Case PD_ButtonImage_RunUninstall
          PSADT_StartUninstall(EventType())          
        Case PD_ButtonImage_RunRepair
          PSADT_StartRepair(EventType())          
        Case PD_ButtonImage_StartPowerShell
          PSADT_StartPowerShell(EventType())          
        Case PD_ButtonImage_ScanEXE
          PSADT_GenerateExecutableList(EventType())          
        Case PD_ButtonImage_RunHelp
          PSADT_StartHelp(EventType())          
        Case PD_Button_ShowLogs
          OpenSoftwareLogs_Folder(EventType())          
        Case PD_Button_EditDeploymentFile
          PSADT_StartPowerShellEditor(EventType())          
        Case PD_Button_Close
          CloseDebuggerWindow(EventType())          
      EndSelect
  EndSelect
  ProcedureReturn #True
EndProcedure



DataSection
  Img_DebuggerWindow_PSADT_0: : IncludeBinary "..\Ressources\Icon_Go.png"
  Img_DebuggerWindow_PSADT_1: : IncludeBinary "..\Ressources\Icon_Uninstall.png"
  Img_DebuggerWindow_PSADT_2: : IncludeBinary "..\Ressources\Icon_PowerShell.png"
  Img_DebuggerWindow_PSADT_3: : IncludeBinary "..\Ressources\Icon_Repair.png"
  Img_DebuggerWindow_PSADT_4: : IncludeBinary "..\Ressources\Icon_Help.png"
  Img_DebuggerWindow_PSADT_5: : IncludeBinary "..\Ressources\Icon_Executable.png"
EndDataSection
