; Form Designer for Purebasic - 6.10
; Warning: this file uses a strict syntax, if you edit it, make sure to respect the Form Designer limitation or it won't be opened again.

;
; This code is automatically generated by the FormDesigner.
; Manual modification is possible to adjust existing commands, but anything else will be dropped when the code is compiled.
; Event procedures needs to be put in another source file.
;

Global MainWindow

Global Container_Start, Image_DropFolder, Text_Introduction, Image_GreenCheck, Image_Website, Button_SelectFolder, Button_DebugPSADT, Hyperlink_PSADT_Folder, Hyperlink_PackageFolder, Frame_Settings, Checkbox_CreatePackageFolder, Checkbox_CreateSubFolders, Combo_InstallerFile, Text_Installer, Button_MSI, Button_PEID, Button_PSAppDeployToolkit, Button_RunInstaller, Button_UploadIntune, Button_CreatePackage, Frame_Commands, Text_InstallCommand, Hyperlink_InstallCommand, Text_UninstallCommand, Hyperlink_UninstallCommand, Text_DetectionCommand, Hyperlink_DetectionMethod, Button_SearchSilentSwitch, Button_SearchIcon, Button_SearchDescription

Global Img_MainWindow_0, Img_MainWindow_1, Img_MainWindow_2, Img_MainWindow_3, Img_MainWindow_4, Img_MainWindow_5

UsePNGImageDecoder()

Img_MainWindow_0 = CatchImage(#PB_Any,?Img_MainWindow_0)
Img_MainWindow_1 = CatchImage(#PB_Any,?Img_MainWindow_1)
Img_MainWindow_2 = CatchImage(#PB_Any,?Img_MainWindow_2)
Img_MainWindow_3 = CatchImage(#PB_Any,?Img_MainWindow_3)
Img_MainWindow_4 = CatchImage(#PB_Any,?Img_MainWindow_4)
Img_MainWindow_5 = CatchImage(#PB_Any,?Img_MainWindow_5)

Enumeration FormFont
  #Font_MainWindow_0
EndEnumeration

LoadFont(#Font_MainWindow_0,"Segoe UI", 9)

Declare SearchIcon(EventType)
Declare ShowAboutWindow(EventType)
Declare OpenPackageFolder(EventType)
Declare SearchDescription(EventType)
Declare SelectFolder(EventType)
Declare StartProcessIdentification(EventType)
Declare CreatePSADTProject(EventType)
Declare SearchSilentSwitch(EventType)
Declare Clipboard_InstallCommand(EventType)
Declare MyInstallerFile(EventType)
Declare Clipboard_DetectionCommand(EventType)
Declare ShowMsiProductCode(EventType)
Declare RunInstallerFile(EventType)
Declare OpenPSADT_Folder(EventType)
Declare ShowDebugWindow_PSADT(EventType)
Declare CreatePackage(EventType)
Declare Batch_IntuneUpload(EventType)
Declare Clipboard_UninstallCommand(EventType)

Procedure OpenMainWindow(x = 0, y = 0, width = 650, height = 860)
  MainWindow = OpenWindow(#PB_Any, x, y, width, height, "Setup Packager 1.5 - TUGI.CH", #PB_Window_SystemMenu | #PB_Window_MinimizeGadget | #PB_Window_ScreenCentered)
  Container_Start = ContainerGadget(#PB_Any, 0, 0, 650, 230)
  SetGadgetColor(Container_Start, #PB_Gadget_BackColor,RGB(255,255,255))
  Image_DropFolder = ImageGadget(#PB_Any, 260, 10, 128, 128, ImageID(Img_MainWindow_0))
  Text_Introduction = TextGadget(#PB_Any, 20, 160, 610, 25, "Drag and drop your folder with the the installer (*.exe, *.msi) inside on the icon.", #PB_Text_Center)
  SetGadgetColor(Text_Introduction, #PB_Gadget_FrontColor,RGB(128,128,128))
  SetGadgetColor(Text_Introduction, #PB_Gadget_BackColor,RGB(255,255,255))
  Image_GreenCheck = ImageGadget(#PB_Any, 360, 90, 48, 48, ImageID(Img_MainWindow_1))
  Image_Website = ImageGadget(#PB_Any, 610, 15, 25, 25, ImageID(Img_MainWindow_3))
  GadgetToolTip(Image_Website, "More about this app")
  Button_SelectFolder = ButtonGadget(#PB_Any, 270, 190, 110, 25, "Select folder")
  Button_DebugPSADT = ButtonGadget(#PB_Any, 270, 190, 110, 25, "Debug PSADT")
  HideGadget(Button_DebugPSADT, 1)
  Hyperlink_PSADT_Folder = HyperLinkGadget(#PB_Any, 180, 190, 320, 30, "PSADT project successfully created! Open here the folder.", 0, #PB_HyperLink_Underline)
  SetGadgetColor(Hyperlink_PSADT_Folder, #PB_Gadget_FrontColor,RGB(0,128,128))
  SetGadgetColor(Hyperlink_PSADT_Folder, #PB_Gadget_BackColor,RGB(255,255,255))
  Hyperlink_PackageFolder = HyperLinkGadget(#PB_Any, 190, 190, 300, 30, "Package successfully created! Open here the folder.", 0, #PB_HyperLink_Underline)
  SetGadgetColor(Hyperlink_PackageFolder, #PB_Gadget_FrontColor,RGB(0,128,128))
  SetGadgetColor(Hyperlink_PackageFolder, #PB_Gadget_BackColor,RGB(255,255,255))
  CloseGadgetList()
  Frame_Settings = FrameGadget(#PB_Any, 20, 250, 610, 190, "Settings")
  Checkbox_CreatePackageFolder = CheckBoxGadget(#PB_Any, 40, 370, 330, 25, "Create package folder in the parent folder of the installer")
  SetGadgetState(Checkbox_CreatePackageFolder, #PB_Checkbox_Checked)
  DisableGadget(Checkbox_CreatePackageFolder, 1)
  Checkbox_CreateSubFolders = CheckBoxGadget(#PB_Any, 40, 400, 330, 25, "Create automatically sub-folders based on todays date")
  Combo_InstallerFile = ComboBoxGadget(#PB_Any, 40, 320, 570, 30)
  DisableGadget(Combo_InstallerFile, 1)
  Text_Installer = TextGadget(#PB_Any, 40, 290, 570, 25, "Select your installation file to create the package:")
  Button_MSI = ButtonImageGadget(#PB_Any, 20, 450, 48, 50, ImageID(Img_MainWindow_4))
  GadgetToolTip(Button_MSI, "Show MSI informations")
  DisableGadget(Button_MSI, 1)
  Button_PEID = ButtonImageGadget(#PB_Any, 80, 450, 50, 50, ImageID(Img_MainWindow_2))
  GadgetToolTip(Button_PEID, "Show PE informations with PEiD")
  DisableGadget(Button_PEID, 1)
  Button_PSAppDeployToolkit = ButtonImageGadget(#PB_Any, 140, 450, 50, 50, ImageID(Img_MainWindow_5))
  GadgetToolTip(Button_PSAppDeployToolkit, "Create PSAppDeployToolkit project")
  DisableGadget(Button_PSAppDeployToolkit, 1)
  Button_RunInstaller = ButtonGadget(#PB_Any, 210, 460, 100, 40, "Run Installer")
  DisableGadget(Button_RunInstaller, 1)
  Button_UploadIntune = ButtonGadget(#PB_Any, 320, 460, 150, 40, "Upload to Intune")
  DisableGadget(Button_UploadIntune, 1)
  Button_CreatePackage = ButtonGadget(#PB_Any, 480, 460, 150, 40, "Create Package")
  DisableGadget(Button_CreatePackage, 1)
  Frame_Commands = FrameGadget(#PB_Any, 20, 530, 610, 250, "Commands for Intune")
  Text_InstallCommand = TextGadget(#PB_Any, 50, 570, 560, 25, "Install:")
  SetGadgetColor(Text_InstallCommand, #PB_Gadget_FrontColor,RGB(128,128,128))
  SetGadgetFont(Text_InstallCommand, FontID(#Font_MainWindow_0))
  Hyperlink_InstallCommand = HyperLinkGadget(#PB_Any, 50, 600, 560, 25, "(Unknown)", 0)
  GadgetToolTip(Hyperlink_InstallCommand, "Copy install command in clipboard")
  SetGadgetColor(Hyperlink_InstallCommand, #PB_Gadget_FrontColor,RGB(0,128,255))
  Text_UninstallCommand = TextGadget(#PB_Any, 50, 640, 560, 25, "Uninstall:")
  SetGadgetColor(Text_UninstallCommand, #PB_Gadget_FrontColor,RGB(128,128,128))
  SetGadgetFont(Text_UninstallCommand, FontID(#Font_MainWindow_0))
  Hyperlink_UninstallCommand = HyperLinkGadget(#PB_Any, 50, 670, 560, 25, "(Unknown)", 0)
  GadgetToolTip(Hyperlink_UninstallCommand, "Copy uninstall command in clipboard")
  SetGadgetColor(Hyperlink_UninstallCommand, #PB_Gadget_FrontColor,RGB(0,128,255))
  Text_DetectionCommand = TextGadget(#PB_Any, 50, 710, 560, 25, "Suggestion for App Detection Method:")
  SetGadgetColor(Text_DetectionCommand, #PB_Gadget_FrontColor,RGB(128,128,128))
  SetGadgetFont(Text_DetectionCommand, FontID(#Font_MainWindow_0))
  Hyperlink_DetectionMethod = HyperLinkGadget(#PB_Any, 50, 740, 560, 25, "(Unknown)", 0)
  GadgetToolTip(Hyperlink_DetectionMethod, "Copy detection method in clipboard")
  SetGadgetColor(Hyperlink_DetectionMethod, #PB_Gadget_FrontColor,RGB(0,128,255))
  Button_SearchSilentSwitch = ButtonGadget(#PB_Any, 20, 800, 310, 40, "Search for Silent Switch")
  Button_SearchIcon = ButtonGadget(#PB_Any, 340, 800, 130, 40, "Search for Icon")
  Button_SearchDescription = ButtonGadget(#PB_Any, 480, 800, 150, 40, "Search for Description")
EndProcedure

Procedure MainWindow_Events(event)
  Select event
    Case #PB_Event_CloseWindow
      ProcedureReturn #False

    Case #PB_Event_Menu
      Select EventMenu()
      EndSelect

    Case #PB_Event_Gadget
      Select EventGadget()
        Case Image_DropFolder
          SelectFolder(EventType())          
        Case Image_Website
          ShowAboutWindow(EventType())          
        Case Button_SelectFolder
          SelectFolder(EventType())          
        Case Button_DebugPSADT
          ShowDebugWindow_PSADT(EventType())          
        Case Hyperlink_PSADT_Folder
          OpenPSADT_Folder(EventType())          
        Case Hyperlink_PackageFolder
          OpenPackageFolder(EventType())          
        Case Combo_InstallerFile
          MyInstallerFile(EventType())          
        Case Button_MSI
          ShowMsiProductCode(EventType())          
        Case Button_PEID
          StartProcessIdentification(EventType())          
        Case Button_PSAppDeployToolkit
          CreatePSADTProject(EventType())          
        Case Button_RunInstaller
          RunInstallerFile(EventType())          
        Case Button_UploadIntune
          Batch_IntuneUpload(EventType())          
        Case Button_CreatePackage
          CreatePackage(EventType())          
        Case Hyperlink_InstallCommand
          Clipboard_InstallCommand(EventType())          
        Case Hyperlink_UninstallCommand
          Clipboard_UninstallCommand(EventType())          
        Case Hyperlink_DetectionMethod
          Clipboard_DetectionCommand(EventType())          
        Case Button_SearchSilentSwitch
          SearchSilentSwitch(EventType())          
        Case Button_SearchIcon
          SearchIcon(EventType())          
        Case Button_SearchDescription
          SearchDescription(EventType())          
      EndSelect
  EndSelect
  ProcedureReturn #True
EndProcedure



DataSection
  Img_MainWindow_0: : IncludeBinary "..\Ressources\Icon_Download.png"
  Img_MainWindow_1: : IncludeBinary "..\Ressources\Icon_Check.png"
  Img_MainWindow_2: : IncludeBinary "..\Ressources\Icon_EXE.png"
  Img_MainWindow_3: : IncludeBinary "..\Ressources\Icon_Info.png"
  Img_MainWindow_4: : IncludeBinary "..\Ressources\Icon_MSI.png"
  Img_MainWindow_5: : IncludeBinary "..\Ressources\Icon_Package.png"
EndDataSection
